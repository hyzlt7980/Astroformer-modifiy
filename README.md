# â˜• Swin-Coffee: é¢å‘ CIFAR-100 çš„ SOTA çº§é«˜æ•ˆç‰¹å¾å»å™ª Transformer

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Framework: PyTorch](https://img.shields.io/badge/Framework-PyTorch-orange.svg)](https://pytorch.org)
[![Dataset: CIFAR-100](https://img.shields.io/badge/Dataset-CIFAR--100-blue.svg)]()
[![Efficiency: SOTA](https://img.shields.io/badge/Efficiency-30s%2Fepoch-green)]()

**Swin-transformer-coffee** (Swin-Coffee) æ˜¯ä¸€æ¬¾ä¸“ä¸ºå°è§„æ¨¡æ•°æ®é›†ï¼ˆå¦‚ CIFAR-100ï¼‰é‡èº«å®šåˆ¶çš„é«˜æ•ˆè§†è§‰ Transformer æ¶æ„ã€‚é’ˆå¯¹ Transformer åœ¨å°æ•°æ®ä¸Šéš¾ä»¥ä»é›¶æ”¶æ•›çš„ç—›ç‚¹ï¼Œæˆ‘ä»¬å¼•å…¥äº† **å·ç§¯å½’çº³åç½®ï¼ˆConvolutional Inductive Biasï¼‰** å’Œ **è‡ªç›‘ç£ç‰¹å¾å»å™ªï¼ˆSelf-Supervised Denoisingï¼‰** æœºåˆ¶ã€‚

åœ¨ **æ— é¢„è®­ç»ƒï¼ˆFrom Scratchï¼‰**ã€**ä»… 300-400 Epoch** çš„æ ‡å‡†è®­ç»ƒå‘¨æœŸä¸‹ï¼ŒSwin-Coffee ä»¥æƒŠäººçš„è®­ç»ƒé€Ÿåº¦ï¼ˆ4å¡ V100 ä»…éœ€ 30s/epochï¼‰è¾¾åˆ°äº† **82.36%** çš„ Top-1 å‡†ç¡®ç‡ï¼Œé‡æ–°å®šä¹‰äº†è½»é‡çº§æ¨¡å‹åœ¨ CIFAR-100 ä¸Šçš„æ•ˆç‡åŸºå‡†ã€‚


82.36ï¼š
4å¡v100,å…ˆç”¨4å¡v100è·‘æ»¡300epoch, ç„¶åé™ä½å™ªå£°å¼ºåº¦115epoch, å…·ä½“githubä¸Šä¼ çš„æ–‡ä»¶:82.36-swin-coffee-æœ€ç»ˆç²¾åº¦cifar-100+log

## ğŸ† æ ¸å¿ƒç«äº‰åŠ›ï¼šæ­å¼€â€œé«˜åˆ†â€çš„çœŸç›¸

åœ¨ CIFAR-100 æ¦œå•ä¸Šï¼Œè®¸å¤šå‡†ç¡®ç‡è¶…è¿‡ 82% çš„æ¨¡å‹å¾€å¾€ä¾èµ–æå…¶æ˜‚è´µçš„è®¡ç®—èµ„æºæˆ–å¤–éƒ¨æ•°æ®ã€‚**Swin-Coffee çš„å‡ºç°ï¼Œè¯æ˜äº†åœ¨ä¸ä¾èµ–â€œå¤–æŒ‚â€çš„æƒ…å†µä¸‹ï¼Œä¾ç„¶å¯ä»¥å®ç° SOTA çº§çš„æ€§èƒ½ã€‚**

### 1. å·…å³°å¯¹å†³ï¼šSwin-Coffee vs. ä¸»æµç«å“

> **âš ï¸ å…³é”®äº‹å®ï¼š** ç›®å‰å¸‚é¢ä¸Šå¤§å¤šæ•°å‡†ç¡®ç‡é«˜äºæœ¬æ¨¡å‹çš„è®ºæ–‡ï¼ˆå¦‚ ViT, ResNet-Strikes-Back ç­‰ï¼‰ï¼Œé€šå¸¸ä½¿ç”¨äº† **ImageNet é¢„è®­ç»ƒ** æˆ–å°†å›¾åƒå¼ºè¡Œä¸Šé‡‡æ ·è‡³ **224x224**ï¼ˆè®¡ç®—é‡å¢åŠ  12 å€ï¼‰ã€‚
>
> **Swin-Coffee åšæŒï¼š** âœ… **æ— é¢„è®­ç»ƒ (From Scratch)** âœ… **ä½åˆ†è¾¨ç‡é«˜æ•ˆæ¨ç† (64x64)**

| æ¨¡å‹ (Model) | é¢„è®­ç»ƒ / åˆ†è¾¨ç‡ | å‚æ•°é‡ | è®­ç»ƒè€—æ—¶ (4xV100) | å‡†ç¡®ç‡ (Top-1) | è¯„ä»· |
| :--- | :---: | :---: | :---: | :---: | :--- |
| **Swin-Coffee (Ours)** | âœ… **æ—  / 64x64** | **26.8M** | **30s / epoch** ğŸš€ | **82.36%** | **æ•ˆç‡ä¹‹ç‹**ã€‚å…¼é¡¾ç²¾åº¦ã€é€Ÿåº¦ä¸è®­ç»ƒæˆæœ¬ã€‚ |
| **ResNet-50 (Timm)** | âŒ ImageNet / 224x224 | 25.6M | - | **85%+** | **ä¾é å¤–éƒ¨æ•°æ®**ã€‚è‹¥æ— é¢„è®­ç»ƒä»…çº¦ 79%ã€‚ |
| **SparseSwin** | âŒ ImageNet / 224x224 | 28M | - | **85.35%** | **ä¾èµ–é¢„è®­ç»ƒ**ã€‚ä¸” 224 åˆ†è¾¨ç‡å¯¼è‡´æ¨ç†ææ…¢ã€‚ |
| **WideResNet** | âœ… æ—  / 32x32 | 36.5M | ~60s / epoch | 81.15% | **ç²¾åº¦è½åã€‚ |
| **PyramidNet-272** | âœ… æ—  / 32x32 | 26.0M | ~150s / epoch | **84.16%** | **ææ…¢**ã€‚272 å±‚æ·±åº¦å¯¼è‡´æ¨ç†å»¶è¿Ÿæé«˜ï¼Œæ— æ³•è½åœ°ã€‚ |
| **DenseNet** | âœ… æ—  / 32x32 | / | / | **82.62** | |
### 2. è‡ªèº«çªç ´ï¼š+16.48% çš„æƒŠäººé£è·ƒ
ç›¸æ¯”äºåŸå§‹ Swin-Tinyï¼ŒSwin-Coffee é€šè¿‡æ¶æ„åˆ›æ–°ï¼Œåœ¨æ›´å°çš„è¾“å…¥åˆ†è¾¨ç‡ä¸‹å®ç°äº†æ€§èƒ½çš„è´¨å˜ã€‚

| æ¨¡å‹ | è¾“å…¥åˆ†è¾¨ç‡ | è®­ç»ƒç­–ç•¥ | å‡†ç¡®ç‡ (Top-1) |
| :--- | :---: | :---: | :---: |
| Swin-Tiny (Baseline) | 64x64 (å¤§å›¾) | Scratch | 65.88% |
| **Swin-Coffee (Ours)** | **64x64 (å°å›¾)** | **Scratch + Denoise** | **82.36%** (+16.48%) |

---

## ğŸ’¡ æ¶æ„åˆ›æ–°ç»†èŠ‚

æˆ‘ä»¬å¹¶æœªç®€å•å †å æ¨¡å—ï¼Œè€Œæ˜¯æ„å»ºäº†ä¸€å¥—**â€œæŠ—å¹²æ‰°ã€å¼ºå½’çº³â€**çš„ç‰¹å¾æå–æµï¼Œä¸“é—¨è§£å†³ Transformer åœ¨å°å›¾ä¸Šæ˜“è¿‡æ‹Ÿåˆçš„é—®é¢˜ã€‚

![æ¶æ„å›¾](swin-coffee.jpg)
![swinçš„æ³¨æ„åŠ›è¿‡ç¨‹](swin-shift-window-attention.jpg)

### ğŸš€ 1. é»„é‡‘åˆ†è¾¨ç‡ç­–ç•¥ (The Sweet Spot)
* **ç­–ç•¥**ï¼šè¾“å…¥ä¸Šé‡‡æ ·è‡³ **64x64**ï¼Œä½† Stem å±‚é‡‡ç”¨ `Conv3x3 (stride=2)` ç›´æ¥é™ç»´è‡³ **32x32**ã€‚
* **ä¼˜åŠ¿**ï¼šæˆ‘ä»¬è·å¾—äº† 64x64 çš„å›¾åƒç»†èŠ‚ä¿¡æ¯ï¼Œä½†å®é™…è®¡ç®—é‡ï¼ˆFLOPsï¼‰å´ç»´æŒåœ¨ 32x32 çš„æ°´å¹³ã€‚è¿™ä½¿å¾—æˆ‘ä»¬çš„**è®¡ç®—é‡ä»…ä¸º WideResNet-28-10 çš„çº¦ 1/10**ã€‚

### ğŸ§  2. Swin-CBAM èåˆ (Stage 1-3)
* **ç—›ç‚¹**ï¼šçº¯ Transformer ç¼ºä¹â€œå½’çº³åç½®â€ï¼Œéš¾ä»¥æ•æ‰å±€éƒ¨è¾¹ç¼˜ã€‚
* **è§£æ³•**ï¼šåœ¨ Swin Block åä¸²è” **CBAM**ã€‚
    * **ç©ºé—´æ³¨æ„åŠ›**ï¼šåˆ©ç”¨å·ç§¯æ ¸å¼ºåˆ¶æå–å±€éƒ¨ç‰¹å¾ã€‚
    * **é€šé“æ³¨æ„åŠ›**ï¼šè‡ªé€‚åº”æ ¡å‡†ç‰¹å¾é€šé“æƒé‡ã€‚

### ğŸŒŠ 3. é¢‘åŸŸæ‰°åŠ¨å¢å¼º (FFT-based Disrupt)
* **æœºåˆ¶**ï¼šåœ¨æµ…å±‚é˜¶æ®µæœ«å°¾å¼•å…¥ **FFT é¢‘åŸŸé®è”½**ã€‚
* **æ•ˆæœ**ï¼šéšæœºä¸¢å¼ƒå›¾åƒçš„é«˜é¢‘/ä½é¢‘åˆ†é‡ï¼Œè¿«ä½¿æ¨¡å‹ä¸ä¾èµ–æ­»è®°ç¡¬èƒŒçº¹ç†ï¼Œè€Œæ˜¯å­¦ä¹ å›¾åƒçš„ç»“æ„åŒ–è¯­ä¹‰ï¼Œæ˜¾è‘—é˜²æ­¢è¿‡æ‹Ÿåˆã€‚

### ğŸ§¹ 4. è‡ªç›‘ç£å»å™ªæ­£åˆ™åŒ– (Stage 4)
* **æœºåˆ¶**ï¼š**åæœŸå»å™ª (Late-Phase Denoising)**ã€‚
    * åœ¨è®­ç»ƒä¸­åæœŸï¼ˆEpoch 30+ï¼‰ï¼Œå‘é«˜å±‚ç‰¹å¾æ³¨å…¥é«˜æ–¯å™ªå£°ã€‚
    * **å¤šä»»åŠ¡å­¦ä¹ **ï¼šæ¨¡å‹ä¸ä»…è¦åˆ†ç±»ï¼Œè¿˜è¦è¿˜åŸå‡ºâ€œå¹²å‡€ç‰¹å¾â€ï¼ˆMSE Lossï¼‰ã€‚
* **æ•ˆæœ**ï¼šè¿™è¿«ä½¿æ¨¡å‹æå–å‡ºå¯¹å™ªå£°ä¸æ•æ„Ÿçš„ã€æœ€æœ¬è´¨çš„ç‰¹å¾è¡¨ç¤ºã€‚

---

## ğŸ› ï¸ é¡¹ç›®ç»“æ„

å½“å‰å¼€æºç‰ˆæœ¬å¯¹åº” **82.36%** SOTA æƒé‡çš„ä»£ç ä¸é…ç½®ã€‚

```text
Swin-Coffee/
â”œâ”€â”€ swin_coffee.py        # æ¨¡å‹æ ¸å¿ƒå®šä¹‰ (SwinCBAM, Disrupt, Denoise Blocks)
â”œâ”€â”€ swin-coffee.jpg       # æ¶æ„å›¾
â”œâ”€â”€ logs/                 # è®­ç»ƒæ—¥å¿—
â”‚   â”œâ”€â”€ training_log_swin_coffee  # 81.92% -> 82.36% çš„è®­ç»ƒè®°å½•
â”‚   â””â”€â”€ training_log_swin_tiny    # Baseline å¯¹æ¯”è®°å½•
â””â”€â”€ weights/              # æœ€ä½³æ¨¡å‹æƒé‡ (å³å°†ä¸Šä¼ 
